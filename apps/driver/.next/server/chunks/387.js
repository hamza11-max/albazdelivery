"use strict";exports.id=387,exports.ids=[387],exports.modules={43387:(a,b,c)=>{c.r(b),c.d(b,{auditAdminAction:()=>j,auditAuthEvent:()=>g,auditDataAccess:()=>h,auditSecurityEvent:()=>i,createAuditLog:()=>e,getClientInfo:()=>f});var d=c(45682);async function e(a){try{console.log("[AUDIT LOG]",{timestamp:new Date().toISOString(),...a});try{await d.z.auditLog.create({data:{userId:a.userId||null,userRole:a.userRole||null,action:a.action,resource:a.resource,resourceId:a.resourceId||null,ipAddress:a.ipAddress||null,userAgent:a.userAgent||null,details:a.details?JSON.parse(JSON.stringify(a.details)):null,status:a.status,errorMessage:a.errorMessage||null}})}catch(a){console.warn("[AUDIT LOG] Database write failed, logged to console only:",a)}}catch(a){console.error("[AUDIT LOG ERROR]",a)}}function f(a){let b=a.headers.get("x-forwarded-for"),c=a.headers.get("x-real-ip");return{ipAddress:a.headers.get("cf-connecting-ip")||c||(b?b.split(",")[0].trim():"unknown"),userAgent:a.headers.get("user-agent")||"unknown"}}async function g(a,b,c,d,g){let h=d?f(d):{ipAddress:"unknown",userAgent:"unknown"};await e({userId:b,userRole:c,action:a,resource:"AUTH",ipAddress:h.ipAddress,userAgent:h.userAgent,status:g?"FAILURE":"SUCCESS",errorMessage:g})}async function h(a,b,c,d,g,h,i){let j=f(h);await e({userId:d,userRole:g,action:a,resource:b,resourceId:c,ipAddress:j.ipAddress,userAgent:j.userAgent,details:i,status:"SUCCESS"})}async function i(a,b,c,d,g){let h=d?f(d):{ipAddress:"unknown",userAgent:"unknown"};await e({userId:b,userRole:c,action:a,resource:"SECURITY",ipAddress:h.ipAddress,userAgent:h.userAgent,details:g,status:"FAILURE"})}async function j(a,b,c,d,g,h){let i=f(g);await e({userId:d,userRole:"ADMIN",action:a,resource:b,resourceId:c,ipAddress:i.ipAddress,userAgent:i.userAgent,details:h,status:"SUCCESS"})}}};